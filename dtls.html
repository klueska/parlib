

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Dynamic Thread Local Storage &mdash; Parlib 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="Parlib 1.0 documentation" href="index.html" />
    <link rel="up" title="API Reference" href="api_reference.html" />
    <link rel="next" title="Thread Local Storage" href="tls.html" />
    <link rel="prev" title="Spinlocks" href="spinlock.html" /> 
  </head>
  <body>
<div style="background-color: white; text-align: left; padding: 10px 10px 0px 10px">
  <div style="float:left">
    <a href="index.html">
      <img src="_static/logo.png" border="0" alt="Parlib"/>
    </a>
  </div>
  <div style="position:relative; top:115px; float:right; font-size:20px;">
    <i>Easing Cross-Platform Development of Next Generation Parallel Systems</i>
  </div>
  <div style="clear:both"></div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tls.html" title="Thread Local Storage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="spinlock.html" title="Spinlocks"
             accesskey="P">previous</a> |</li>
  <li><a href="index.html">Home</a>|&nbsp;</li>
  <li><a href="api_reference.html">API Reference</a>|&nbsp;</li>
  <li><a href="search.html">Search</a>|&nbsp;</li>
  <li><a href="about.html">About</a>|&nbsp;</li>
  <li><a href="sitemap.html">Sitemap</a>&raquo;</li>

          <li><a href="api_reference.html" accesskey="U">API Reference</a> &raquo;</li> 
      </ul>
    </div>

  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <img src="_static/amplab.png" width=100% border="0" alt="Amplab"/>
  

  <h3><a href="sitemap.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Dynamic Thread Local Storage</a><ul>
<li><a class="reference internal" href="#types">Types</a></li>
<li><a class="reference internal" href="#api-calls">API Calls</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="spinlock.html"
                        title="previous chapter">Spinlocks</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tls.html"
                        title="next chapter">Thread Local Storage</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/dtls.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="dynamic-thread-local-storage">
<h1>Dynamic Thread Local Storage<a class="headerlink" href="#dynamic-thread-local-storage" title="Permalink to this headline">¶</a></h1>
<p>Dynamic thread local storage is parlib&#8217;s way of providing pthread_key_create()
and pthread_set/get_specific() style sematics for uthreads and vcores. Using
dtls, different libraries can dynamically define their own set of dtls keys for
thread local storage.  Uthreads and vcores can then access the private regions
associated with these keys through the API described below.</p>
<p>To access the dynamic thread local storage API, include the following header file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#include &lt;parlib/dtls.h&gt;</span>
</pre></div>
</div>
<div class="section" id="types">
<h2>Types<a class="headerlink" href="#types" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>struct dtls_key;
typedef struct dtls_key dtls_key_t;
typedef void (*dtls_dtor_t)(void*);</pre>
</div>
<dl class="type">
<dt id="dtls_key">
struct <tt class="descname">dtls_key</tt><a class="headerlink" href="#dtls_key" title="Permalink to this definition">¶</a></dt>
<dt id="dtls_key_t">
<tt class="descname">dtls_key_t</tt><a class="headerlink" href="#dtls_key_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A dynamic thread local storage key. Uthreads and vcores use these keys to
gain access to their own thread local storage region associated with the key.
Multiple keys can be created, with each key referring to a different set of
thread local storage regions.</p>
</dd></dl>

<dl class="type">
<dt id="dtls_dtor_t">
<tt class="descname">dtls_dtor_t</tt><a class="headerlink" href="#dtls_dtor_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A function pointer defining a destructor function mapped to a specific
dtls_key.  Whenever a uthread has accessed a dtls_key that has a dtls_dtor_t
mapped to it, the destructor function will be called before the uthread
exits.</p>
</dd></dl>

</div>
<div class="section" id="api-calls">
<h2>API Calls<a class="headerlink" href="#api-calls" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>dtls_key_t dtls_key_create(dtls_dtor_t dtor);
void dtls_key_delete(dtls_key_t key);
void set_dtls(dtls_key_t key, void *dtls);
void *get_dtls(dtls_key_t key);
void destroy_dtls();</pre>
</div>
<dl class="function">
<dt id="dtls_key_create">
<a class="reference internal" href="#dtls_key_t" title="dtls_key_t">dtls_key_t</a> <tt class="descname">dtls_key_create</tt><big>(</big><a class="reference internal" href="#dtls_dtor_t" title="dtls_dtor_t">dtls_dtor_t</a><em>&nbsp;dtor</em><big>)</big><a class="headerlink" href="#dtls_key_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a dtls key for dynamically setting/getting thread local storage on
a uthread or vcore. Takes a dtls_dtor_t as a paramameter and associates it
with a new dtls_key_t, which gets returned.</p>
</dd></dl>

<dl class="function">
<dt id="dtls_key_delete">
void <tt class="descname">dtls_key_delete</tt><big>(</big><a class="reference internal" href="#dtls_key_t" title="dtls_key_t">dtls_key_t</a><em>&nbsp;key</em><big>)</big><a class="headerlink" href="#dtls_key_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete the provided dtls key.</p>
</dd></dl>

<dl class="function">
<dt id="set_dtls">
void <tt class="descname">set_dtls</tt><big>(</big><a class="reference internal" href="#dtls_key_t" title="dtls_key_t">dtls_key_t</a><em>&nbsp;key</em>, void<em>&nbsp;*dtls</em><big>)</big><a class="headerlink" href="#set_dtls" title="Permalink to this definition">¶</a></dt>
<dd><p>Associate a dtls storage region for the provided dtls key on the current
uthread or vcore.</p>
</dd></dl>

<dl class="function">
<dt id="get_dtls">
void *<tt class="descname">get_dtls</tt><big>(</big><a class="reference internal" href="#dtls_key_t" title="dtls_key_t">dtls_key_t</a><em>&nbsp;key</em><big>)</big><a class="headerlink" href="#get_dtls" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dtls storage region previously assocaited with the provided dtls key
on the current uthread or vcore. If no storage region has been associated
yet, return NULL.</p>
</dd></dl>

<dl class="function">
<dt id="destroy_dtls">
void <tt class="descname">destroy_dtls</tt><big>(</big><big>)</big><a class="headerlink" href="#destroy_dtls" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy all dtls storage associated with all keys for the current uthread or
vcore.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tls.html" title="Thread Local Storage"
             >next</a> |</li>
        <li class="right" >
          <a href="spinlock.html" title="Spinlocks"
             >previous</a> |</li>
  <li><a href="index.html">Home</a>|&nbsp;</li>
  <li><a href="api_reference.html">API Reference</a>|&nbsp;</li>
  <li><a href="search.html">Search</a>|&nbsp;</li>
  <li><a href="about.html">About</a>|&nbsp;</li>
  <li><a href="sitemap.html">Sitemap</a>&raquo;</li>

          <li><a href="api_reference.html" >API Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, The Regents of the University of California.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>